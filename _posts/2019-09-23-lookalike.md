---
layout: single
title:  "A Sub-linear, Massive-scale Look-alike Audience Extension System"
header:
  teaser: "images/kaylee123/lookalike.png"
  overlay_color: "#000"
  overlay_filter: "0.5"
  overlay_image: images/kaylee123/custom-modeling.png
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
excerpt: "이 포스트에서 리뷰할 논문의 Yahoo!에서 만든 lookalike 모델입니다."    
categories: 
  - Paper Review
tags:
  - online advertising
  - look-alike model

author: Kay Lee

toc: true
toc_label: "목차"
toc_icon: "cog"
---




## 코드 원본 및 참고 자료

*  [A Sub-linear, Massive-scale Look-alike Audience Extension System](http://proceedings.mlr.press/v53/ma16.pdf)



## 0. Abstraction
- 유사 유저(look-alike audience) 확장은 온라인 광고에서 고성능 잠재 고객(high performance audience)를 맞춤 설정할 수 있는 실질적으로 효과적인 방법임.
- 유사 유저 확장 시스템을 사용하면 광고주들은 정교한 광고 시스템에서 세부적으로 타겟팅 가능한 속성을 몰라도 기존 고객 목록을 제공함을서 맞춤형 고객층을 쉽게 생성할 수 있음.
- 이 논문에서는 유사 유저에게 수천개의 캠페인을 제공하는 야후의 광고 플랫폼의 새롭게 개발된 그래프 기반의 유사 유저 시스템을 다룸.
- 기존의 세가지의 다른 유사 유저 시스템들과  비교하기 위한 실험이 이루어짐.
- 실험 결과에 따르면 최근접 이웃 필터링(nearest-neighbor filtering)한 그래프 기반 방법이 앱 설치 광고 캠페인의 전환율에서 다른 방법보다 50% 이상 성능이 뛰어남.

## 1. Introduction

- 온라인 광고 캠페인에서 유사 유저 모델을 사용하면 광고주가 기존의 고객과 유사한 유저에게 도달할 수 있음.
- 이전 구매자 목록, 웹 서비스 구독자, 특정 앱 설치 프로그램, 브랜드 애호가, CRM 시스템 고객, 광고 클릭자, 특정 정치인 지지자, 스포츠 팀의 팬 등과 유사한 유저를 타겟팅하는 것과 같은 비지니스 목표를 서포트하는데 사용되어짐.
- 유사 유저 확장 기술의 장점은 온라인 광고의 다른 타겟팅 기술과 비교하였을 때 매우 관련있는 고객들에게 도달할 수 있는 방법을 대폭 단순화하였다는 것임.
- 광고주는 사용자 목록을 업로드하여 커스터마이즈된 오디언스(audience)를 사용
- 유사 유저 시스템의 인풋은 사용자 ID(예 : 브라우저 쿠키, 주소, 전화번호, 똔느 기타 식별자 목록) 리스트으로 시드('SEEDS')라고 부름.
- 시드 사용자들은 지난 광고 캠페인 또는 더 강력한 구매력을 지닌 기존 고객으로 변환되어질 수 있음.
- 아웃풋은 유사 유저 모델에 따라 시드와 유사하게 보이는 사용자의 목록임.
- 유사 유저의 효과는 여러 비즈니스 관점에서 측정됨.
  - 확장성(Scalability)
    - 유사 유저 아웃풋의 최대 사이즈는 얼마인지?
    - 합리적인 규모의 유저를 도출할 수 있는 상한과 하한은 얼마인지?
  - 성능(Performance)
    - 광고주가 시드 목록을 업로드한 후 시스템이 유사 유저를 얼마나 빠르게 생성할 수 있는지?
    - 실제 광고 캠페인에서 유사 유저가 달성할 수 있는 ROI 상승도는 얼마인지?
  - 투명성(Transparency)
    - 시스템이 블랙박스로 작동하는지?
    - 아니면 광고 캠페인 설정 중에 피드백과 인사이트를 얼마나 빨리 생성할 수 있는지?
    - 몇 초 또는 며칠 안에 피드백과 인사이트를 생성할 수 있는지?
- 다시 말해 모델의 확장성, 성능, 투명성에 대해서 서로 다른 요구 사항이 주어졌을 때 유사유저 확장 시스템의 유일한 '최상'의 설계는 없음. 야후의 시스템의 주요한 기여는 다음과 같이 요약 가능함.
  - 유사유저의 쿼리 시간이 쿼리 유저 수의 부분 선형(sub-linear)인 야후의 대규모 유사 유저 확장 시스템을 제시함. 유사 유저 시스템의 코어 모델은 user2user 쌍별 유사도들에 대한 그래프 마이닝과 머신러닝 기술에 기반하고 있음. 이 시스템에서는 4시간 이내에 30억명 이상의 사용자에게 3000개 이상의 캠페인을 할당할 수 있음.
  - 실제 앱 설치 캠페인 데이터를 사용한 광범위한 실험을 통해 야후의 방법에 의해 추천된 유사 유저가 기존의 다른 유사 유저 모델보다 앱 설치율을 50% 이상 높였음.
  - 또한, 대규모 유사 유저 시스템을 개발하는데 있어 경험을 논의 하거나 어려움을 토론할 수 있음. 가중된 user2user 유사도 그래프를 사용하여 앱설치율은 11% 더 향상시킬 수 있음을 증명함.

## 2. Existing Look-alike Methods & Systems

- 두 사용자 간의 유사성은 그들의 feature들에 의해 만들어짐.
- 한 유저 $$u_i$$는 feature vector $$f_i = (f_i,1, ... , f_i,K)$$로 특성화될 수 있음.
- 온라인 광고 시스템에서 각각의 feature $$f_i,k$$는 연속적(예: 특정 사이트에서 보낸 시간)이거나 또는 (거의 대부분의 경우) 범주 또는 이진형(예: 특정 모바일 앱 사용여부)임.
- feature는 유저의 속성, 사화적인 상호작용, 사전 구축된 잠재고객 세그먼트 등으로 부터 올 수 있음.
- 회사마다 비지니스와 사용자에 이해를 바탕으로 다른 feature를 사용하여 유저를 나타냄.
- feature vector의 크기는 수천~수백만까지 다양함
- 이 논문에서는 $$f_ij {0,1}$$ 과 필요하다면 여러 이진 feature로 분류할 수 있는 연속적인 feature들이 고려됨.
- 비지니스 motivation은 간단하고 직선적이지만 유사 유저 모델링의 사전 작업이 상당히 부족하다는 [Shen et al. (2015)]()의 견해에 동의함.
- 우리가 아는 한 유사 유저는 시스템은 온라인에서 사용되고 있음.
- 광고 산업은 세 가지 범주로 분류할 수 있음 : 단순한 유사도 기반 모델, 회귀 기반 모델, 세그먼드 추정 기반 모델



### 2.1 Simple Similarity-based Look-alike System
 - 유사 유저를 찾는 간단한 방법은 시스템에서 모든 시드 사용자와 사용 가능한 쌍을 비교한 다음 거리(유사도) 측정에 따라 유사성을 결정하는 것
 - 단순한 유사도 기반 유사 유저 시스템은 user2user 유사도를 사용하여 시드처럼 보이는 유저를 찾을 수 있음.
 - 두 사용자 $$u_i$$와 $$u_j$$의 유사성은 feature vector $$sim(f_i,f_j)$$에 따라 정의됨.
 - 코사인 유사도(연속 feature의 경우, 식 1)와 자카드 유사도(이진 feature의 경우, 식2)는 가능한 두가지 측정값임.

<img src="/images/kaylee123/0903/eq1.PNG">

 - seed 유저 set $$S = {u_i, f_j}$$와 주어진 유저 $$u_i$$(feature vector $$f_i$$) 간의 유사도는 시드 유저로부터 가장 유사한 유저의 유사도로 계산되어질 수 있음.

 <img src="/images/kaylee123/0903/eq3.PNG">

 - 보다 복잡한 방법은 user2user 유사도를 확률적으로 집계하는 것임.
 - 이 방법은 0과 1 사이에서 엄격하게 제한된 user2user 유사도들에 대해서만 작동함.
 - 쌍 유사도는 유사한 결정을 촉발할 확률로 다루어짐.
 - 따라서 유저와 시드셋의 유사도는 다음과 같이 측정될 수 있음

 <img src="/images/kaylee123/0903/eq4.PNG">
 
 - 유사도 기반 방법은 소규모로 쉽게 구현할 수 있음.
 - 사용자 feature space에 있는 모든 시드가 보유한 정보를 활용할 수 있는 이점이 있음.
 - 그러나 이 방법에는 몇가지 주의 사항이 있음
  - 첫번째는 확장성으로 많은 수의 사용자 간의 쌍별 유사도를 계산하는 것이 어려움. 무차별하게 대입하는 방법은 N명의 후보자와 k개의 feature를 갖는 M 시드에 대해 계산 복잡도 $O(kMN)$. 일반적인 온라인 광고 시장에서는 수십억명의 후보자와 사용자 당 수백 feature를 가진 수만 명의 씨드가 있음.
  - 두번째 주의 사항은 시드 사용자의 다른 feature들이 동일하게 다루어지기 때문에 (유사도 기반) 모델은 가장 관련이 높은 후보자를 식별하는 능력이 구별되지 않는 것임.  예를 들어 광고 클릭 또는 전환에 대한 예측 능력은 고려되지 않음. 그래서 덜 중요한 후보자가 덜 중요한 feature의 유사도로 인해 유사 유저로 간주될 수 있음.


### 2.2 Regression-based Look-alike System
 - 온라인광고를 위한 또 다른 유형의 유사 유저 시스템은 [Qu et al. (2014)](https://patents.google.com/patent/US8655695B1/en) 로지스틱 회귀에 의한 것임.
 - 특정 벡터 $$f_i$$를 가진 주어진 사용자 $$u_i$$의 경우 로지스틱 회귀 모델을 학습하고 다음과 같이 시드와 유사할 확률을 모델링할 수 있음.

 <img src="/images/kaylee123/0903/22.PNG">

 - 시드는 일반적으로 긍정적인 예로 취급됨.
 - 반면 부정적인 예를 선택하는 몇가지 옵션이 있음.
 - 가장 간단한 네거티브 예제 세트는 비 시드 사용자의 샘플일 수 있음.
 - 잠재적인 광고 변환기가 비 시드 사용자에게도 포함될 수 있으므로 최선의 선택이 아님.
 - 다른 선택은 광고 서버 로그를 처리하여 과거에 광고주의 광고를 보았지만 전환되지 않은 사용자를 찾는 것임.
 - 그러난 콜드 스타트 문제로 어려움을 겪고 있음. 시드가 새로운 광고주의 것이구나 새로운 광고 캠페인에 사용될 경우 광고를 본 사용자가 없음. 
 - 피처의 수가 많은 경우 최종 모델에서 0이 아닌 값의 수를 줄이기 위해 L1 정규화를 손실 함수에 적용하여 피처를 선택함.
 - 실제로 Vowpal Wabbit와 같은 기계학습 패키지는 하둡 클러스터에서 대규모로 로지스틱 회귀를 훈련하고 대규모 사용자에게 이러한 확률을 예측할 수 있는 유연하고 확장 가능한 솔루션을 제공함.
 - 이 모델링 방법의 장점은 시드에 의해 전달된 정보가 모델로 압축되고 사용자를 닮은 모양으로 평가하기 위해 시드의 특징 벡터를 기억할 필요가 없음.
 - 큰 이점 외에 회귀 모델링 방법을 유사 유저 문제에 적용할 경우 몇가지 주의 사항이 있음.
  - LR은 많은 연결, 교차, 또는 기타 종속성을 feature에 포함시킬 수 있는 선형 모델이지만 사용자들을 클러스터링하는데는 효율적이지 않을 수 있음.
  - 제안된 시스템과 비교하기 위해 LR 기반 유사 유저 시스템을 구현함.

### 2.3 Segment Approximation-based Look-alike System
 - 다른 유형의 유사 유저는 사용자 세그먼트에 기초하며, 여기서 사용자 세그먼트는 사용자 관심 카테고리와 같이 사용자의 특성일 수 있음.
 - 예를들어 사용자가 NBA 게임을 좋아하는 경우 이 사용자는 스포츠 세그먼트에 속하는 것으로 간주됨.
 - 다른 방법과 비교하여, 세그먼트 근사 기반 시스템은 사전 구축된 사용자 세그먼트를 사용자의 feature로 사용함.
 - 세그먼트 근사 기반 방법의 아이디어는 가능한 많은 시드 사용자가 공유한 최상위 세그먼트를 찾는 것임.
 - 여기서는 [Turn Inc, Shen et al.(2015)]()의 가장 최근 발표된 세그먼트 근사 기반 방법 중 하나를 설명함.
 - 그들의 접근 방식에서는 각 사용자는 $$u_i = {c_i1, ... , c_ik}$$의 세그먼트츠의 bag으로 표시됨.
 - 유사 유저 확장에 대한 최적화 목표는 광고주가 제공한 세그먼트 셋 C(시드 사용자에 표시된 세그먼트)를 고려할 때 다음 세가지 특성을 만족한 세그먼트 셋이 $$C'$$인 신규 사용자를 추천하는 것임.

<img src="/images/kaylee123/0903/eq5.PNG">

 - 여기서 $$aud(C)$$는 C에 세그먼트가 있는 오디언스 셋이고, $$perf(aud(C))$$는 $$aud(C)$$의 클릭률과 전환율에 따른 성능을 의미함.
 - 직관적으로 아래와 같은 의미임
  - (1) 확장된 오디언스 셋 $$aud(C')$$는 시드 오디언스 $$aud(C)$$의 충분히 유사함(유저가 겹친다는 관점에서)
  - (2) 확장된 오디언스 셋 $$aud(C')$$은 시드 오디언스 $$aud(C)$$와 비교해 더 좋아야 함.
  - (3) 확장된 오디언스 셋 $$aud(C')$$의 크기는 시드 오디언스 $$aud(C)$$보다 훨씬 커야 함.
 - 위의 속성을 만족하는 세그먼트가 여러 개 있을 수 있으므로 세그먼트의 중요성을 구별하기 위한 스코어링 기능이 필요함. 
 - Shen et al. (2015) 은 셋 커버 알고리즘의 적용인 그리디 방법과 가중 criteria에 기반한 알고리즘을 논의함.
 - 새로 추천된 카테고리(or 세그먼트) 갱신에 대해 위의 세가지 기능(수식 5,6,7)을 결합하여 점수를 계산함.

<img src="/images/kaylee123/0903/eq8.PNG">

 - 사전 구축된 세그먼트의 품질이 높고 적용 범위가 좋은 경우 세그먼트 근사가 잘 작동함.
 - 특히 대규모 브랜딩 광고주의 경우에 잘 작동하고, 소규모 광고주에는 유용하지 않을 수 있음.
 - 사전 빌드 프로세스에서는 유사 유저 생성을 지연시킬 수 있는 또 다른 계산 파이프라인이 도입되었음.
 - 대규모 비교를 위한 또 다른 방법으로 위에서 설명한 알고리즘을 구현함.

## 3. Graph-Constraint Look-Alike System

 - 이 섹션에서는 단순 유사성과 회귀 기반 방법을 장점을 모두 활용할 수 있도록 그래프 제약 유사 유저 시스템의 세부 정보를 제공함.
 - 먼저, 전역 user2user 유사도 그래프를 구축되어 후보 유저를 가장 가까운 시드의 이웃으로 제한할 수 있음.
 - 그런 다음 후보 유저는 광고 캠페인의 관련된 기능의 중요성에 따라 순위가 결정
 - 모든 사용자에 대해 광고 캠페인 당 유사 잠재 고객을 교육하고 점수를 매기는 것은 효율성이 낮은 프로세스임.
 - 일반적으로 비슷한 오디언스의 규모는 백만~천만이며, 이는 10억 사용자 풀에서 0.1%~1%임. 
 - 관련없는 사용자를 많이 계산하면 많은 양의 계산 리소스가 낭비됨.
 - 또한 관련없는 99%의 사용자에 대한 feature 가중치를 얻는 훈련을 유저를 샘플링하는 어려운 문제에 직면함.
 - 그래서 글로벌 그래프 구성과 캠페인별 모델링 두 단계로 유사유저를 생성한느 것을 제안함.

### 3.1. Phase I: Global Graph Construction
 - 



### 3.2 Phase II: Campaign Specific Modeling
- 



### 3.3. System Design and Pipeline

#### Construct global user graph
#### Collect candidate users
#### Compute feature importance
#### Score and recommend audience



## 4. Experiment & Evaluation
### 4.1 Evaluation Methodolog
### 4.2. Data and Evaluation Metrics
#### User features
#### Seeds
#### Performance metric

## 5.Discussions

### Weighted LSH

### Seed size effect

## 6. Related Work

## 7. Conclusion